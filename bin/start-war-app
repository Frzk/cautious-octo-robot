#!/usr/bin/env bash

source "$(dirname "$( realpath "$0" )")/utils.sh"


if [ -z "${WAR_PATH}" ]; then
    # WAR_PATH is not defined, we'll have to look fo the .war file ourselves:
    java::war::find_war "${BUILD_DIR}"
fi

if [ -n "${WAR_PATH}" ]; then

    if [ ! -f "${HOME}/${WAR_PATH}" ]; then
        cat << EOF >&2
The WAR_PATH environment variable points to a non-existing file.
Aborting.
EOF
        exit 1
    fi

    java "${JAVA_OPTS}" -jar ./webapp-runner.jar \
        --port "${PORT}" \
        "${HOME}/${WAR_PATH}"
fi
